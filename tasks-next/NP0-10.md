# ID: NP0-10

## Title

Font pipeline hardening (WOFF2 + preload + cache policy)

## Status

DONE

## Context

Fonts are shipped as multiple `.ttf` files and preloaded as TTF in `app/layout.tsx`. This is a performance risk on low bandwidth and can inflate SW caches.

## Steps

1. Convert critical fonts to WOFF2 and reduce shipped weights to those actually used.
2. Update CSS `@font-face` to prefer WOFF2 and keep `font-display: swap`.
3. Update preload tags to WOFF2 and validate with Lighthouse CI.
4. Ensure SW caching covers fonts appropriately without bloat.

## Acceptance Criteria

- Lighthouse thresholds pass with improved font transfer sizes.
- Typography remains correct for fa-IR/RTL.

## Dependencies

- Pairs well with NP0-07 (SW contract).

## Files to modify

- `public/fonts/*`
- `app/globals.css`
- `app/layout.tsx`
- `public/sw.js`
- `lighthouserc.json`

## Implementation Notes

- Added WOFF2 versions for critical font weights (`Regular`, `Bold`) under `public/fonts/`.
- Updated CSS `@font-face` to prefer WOFF2 with TTF fallback and `font-display: swap`.
- Updated global preload links in `app/layout.tsx` from TTF to WOFF2.
- SW static cache extensions already include `.woff2`, keeping font caching aligned with offline strategy.

## Verification

- `pnpm quality:links:check`
- `pnpm ci:contracts`
